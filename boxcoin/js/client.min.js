"use strict";!function(){function t(t){return BXC_TRANSLATIONS&&t in BXC_TRANSLATIONS?BXC_TRANSLATIONS[t]:t}function e(t,e=-1){return _.loading(t,e)}function n(t,e={},n=!1){return _.ajax(t,e,n)}function i(t,e=!0){return _.activate(t,e)}function a(t){return t.closest(".bxc-main")}function r(t){for(var e=t.split("?").pop().split("&"),n={},i=0;i<e.length;i++){var a=e[i].split("=");n[a[0]]=a[1]}return n}function c(t,e=-1,n={}){if(-1===e){let e=localStorage.getItem(t);return e?JSON.parse(e):n}localStorage.setItem(t,JSON.stringify(e))}function o(t){let i=T(t.closest(".bxc-main")),a=i.find(".bxc-vat");a.e.length&&(e(a),n("vat",{amount:i.attr("data-start-price"),country_code:T(t.options[t.selectedIndex]).attr("data-country-code"),currency:i.attr("data-currency")},t=>{a.html(t[4]),a.attr("data-country",t[3]).attr("data-country-code",t[2]).attr("data-amount",t[1]).attr("data-percentage",t[5]),i.attr("data-price",t[0]),i.find(".bxc-amount-fiat-total").html(t[0]),e(a,!1)}))}function s(){l.on("click",".bxc-clipboard",function(){let e=T(this).find("span"),n=e.html();navigator.clipboard.writeText(window.atob(T(this).attr("data-text"))),e.html(t("Copied")),i(this),setTimeout(()=>{i(this,!1),e.html(n)},2e3)})}var l,d,u,p,f,h=!1,m="",x={},b={},g="undefined",v=typeof BXC_ADMIN!==g||document.getElementsByClassName("bxc-admin").length,y=document.getElementsByTagName("script"),C=typeof BXC_LANGUAGE!==g&&BXC_LANGUAGE,T=function(t){return"object"==typeof t&&"e"in t?t:new T.init("string"==typeof t?document.querySelectorAll(t):t)};T.init=function(t){this.e="SELECT"==t.tagName||void 0===t[0]&&!NodeList.prototype.isPrototypeOf(t)?[t]:t},T.ajax=function(t,e=!1,n=!1,i="POST"){let a=new XMLHttpRequest,r="";if(a.open(i,t,!0),e)if("bxc_wp_ajax"==e.action){for(var c in e)"object"==typeof e[c]&&(e[c]=JSON.stringify(e[c]));r=new URLSearchParams(e).toString(),a.setRequestHeader("Content-type","application/x-www-form-urlencoded")}else(r=new FormData).append("data",JSON.stringify(e));a.onload=(()=>{n&&n(a.responseText)}),a.onerror=(()=>!1),a.send(r)},T.extend=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},T.documentHeight=function(){let t=document.body,e=document.documentElement;return Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight)},T.init.prototype.on=function(t,e,n){for(var i=0;i<this.e.length;i++)this.e[i].addEventListener(t,function(t){for(var i=t.target;i&&i!==this;)i.matches(e)&&n.call(i,t),i=i.parentNode})},T.init.prototype.addClass=function(t){for(var e=0;e<this.e.length;e++)this.e[e].classList.add(t);return T(this.e)},T.init.prototype.removeClass=function(t){t=t.trim().split(" ");for(var e=0;e<t.length;e++)for(var n=0;n<this.e.length;n++)this.e[n].classList.remove(t[e]);return T(this.e)},T.init.prototype.toggleClass=function(t){for(var e=0;e<this.e.length;e++)this.e[e].classList.toggle(t);return T(this.e)},T.init.prototype.setClass=function(t,e=!0){for(var n=0;n<this.e.length;n++)e?T(this.e[n]).addClass(t):T(this.e[n]).removeClass(t);return T(this.e)},T.init.prototype.hasClass=function(t){return!!this.e.length&&this.e[0].classList.contains(t)},T.init.prototype.find=function(t){return 0===t.indexOf(">")&&(t=":scope"+t),!!this.e.length&&T(this.e[0].querySelectorAll(t))},T.init.prototype.parent=function(){return!!this.e.length&&T(this.e[0].parentElement)},T.init.prototype.prev=function(){return T(this.e[0].previousElementSibling)},T.init.prototype.next=function(){return T(this.e[0].nextElementSibling)},T.init.prototype.attr=function(t,e=!1){return!1===e?this.e[0].getAttribute(t):(e?this.e[0].setAttribute(t,e):this.e[0].removeAttribute(t),T(this.e))},T.init.prototype.html=function(t=!1){if(this.e.length)return!1===t?this.e[0].innerHTML:("string"==typeof t||"number"==typeof t?this.e[0].innerHTML=t:this.e[0].appendChild(t),T(this.e))},T.init.prototype.append=function(t){var e=document.createElement("template");return e.innerHTML=t.trim(),this.e[0].appendChild(e.content.firstChild),T(this.e)},T.init.prototype.prepend=function(t){return this.e[0].innerHTML=t+this.e[0].innerHTML,T(this.e)},T.init.prototype.replace=function(t){return this.e[0].outerHTML=t,T(this.e)},T.init.prototype.remove=function(){for(var t=0;t<this.e.length;t++)this.e[t].remove()},T.init.prototype.data=function(){let t={};for(var e=0,n=this.e[0].attributes,i=n.length;e<i;e++)t[n[e].nodeName.substr(5)]=n[e].nodeValue;return t},T.init.prototype.is=function(t){return!(1!=this.e[0].nodeType||!this.e.length)&&(t=t.toLowerCase(),this.e[0].tagName.toLowerCase()==t||T(this).attr("type")==t)},T.init.prototype.index=function(){return[].indexOf.call(this.e[0].parentElement.children,this.e[0])},T.init.prototype.siblings=function(){return this.e[0].parentNode.querySelectorAll(":scope > *")},T.init.prototype.length=function(){return this.e.length},T.init.prototype.val=function(t=null){if(null!==t)for(var e=0;e<this.e.length;e++)this.e[e].value=t;return this.e.length?this.e[0].value:""},T.load=function(t=!1,e=!0,n=!1,i=!1){let a=document.createElement(e?"script":"link");t?(e?a.src=t:a.href=t,a.type=e?"text/javascript":"text/css"):a.innerHTML=i,n&&(a.onload=function(){n()}),e||(a.rel="stylesheet"),document.head.appendChild(a)},window._query=T;var _={loading:function(t,e=-1){return t=T(t),-1!==e?t.setClass("bxc-loading",!0===e):!!t.hasClass("bxc-loading")||(this.loading(t,!0),!1)},activate:function(t,e=!0){return T(t).setClass("bxc-active",e)},ajax:function(t,e=!1,n=!1){e.function=t,e.language=C,T.ajax(BXC_URL+"ajax.php",e,t=>{let e=!1,i=!1;try{e=!((i=JSON.parse(t))&&"success"in i&&i.success)}catch(t){e=!0}e?(l.find(".bxc-loading").removeClass("bxc-loading"),console.error(t),b[f]=!1):n&&n(i.response)})},cookie:function(t,e=!1,n=!1,i="get",a=!1){let r="https:"==location.protocol?"SameSite=None;Secure;":"";if("get"==i){let e=document.cookie.split(";");for(var c=0;c<e.length;c++){for(var o=e[c];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t)){let e=o.substring(t.length+1,o.length);return e||!1}}return!1}if("set"==i){let i=new Date;i.setTime(i.getTime()+n*(a?1:86400)*1e3),document.cookie=t+"="+e+";expires="+i.toUTCString()+";path=/;"+r}else this.cookie(t)&&(document.cookie=t+"="+e+";expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;"+r)},beautifyTime:function(e,n=!1,i=!1){let a;if("0000-00-00 00:00:00"==e)return"";if(e.indexOf("-")>0){let t=e.split(/[- :]/);a=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])}else{let t=e.split(/[. :]/);a=new Date(t[2],t[1]-1,t[0],t[3],t[4],t[5])}let r=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds())),c=Math.round((new Date-r)/864e5)*(i?-1:1),o=[t("Sunday"),t("Monday"),t("Tuesday"),t("Wednesday"),t("Thursday"),t("Friday"),t("Saturday")],s=r.toLocaleTimeString("en-EN",{hour:"2-digit",minute:"2-digit"});return"0"===s.charAt(0)&&(s.includes("PM")||s.includes("AM"))&&(s=s.substring(1)),c<1?`<span>${t("Today")}</span>${n?` <span>${s}</span>`:""}`:c<8?`<span>${o[r.getDay()]}</span>${n?` <span>${s}</span>`:""}`:`<span>${r.toLocaleDateString()}</span>${n?` <span>${s}</span>`:""}`},search:function(t,e){let n=T(t).parent().find("i"),i=T(t).val().toLowerCase().trim();n.hasClass("bxc-loading")||(i!=m?(clearTimeout(h),h=setTimeout(()=>{m=i,e(i,n),this.loading(n)},200)):this.loading(n,!1))},searchClear:function(t,e){T(t).next().val()&&(T(t).next().val(""),e())},getURL:function(t=!1,e=!1){if(e||(e=location.search),!t){for(var n=e.split("?").pop().split("&"),i={},a=0;a<n.length;a++){var r=n[a].split("=");i[r[0]]=SBF.escape(r[1])}return i}return e.indexOf("?")>0&&(e=e.substr(0,e.indexOf("?"))),_.escape(decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(e)||[,""])[1].replace(/\+/g,"%20")||""))},escape:function(t){return t?t.replaceAll("<script","&lt;script").replaceAll("</script","&lt;/script").replaceAll("javascript:","").replaceAll("onclick=","").replaceAll("onerror=",""):t},checkout:{settings:function(t){let e=(t=T(t)).attr("data-boxcoin"),n={checkout_id:e};return e.includes("custom")?T.extend(n,T(t).data()):n},init:function(t,e,n=!1){let i=this.storageTransaction(t.checkout_id);T.ajax(BXC_URL+"init.php",{checkout:t,language:C},t=>{if((e=T(e)).html(t),i){if(f=e.attr("data-boxcoin"),p=e.find("> .bxc-main"),!["stripe","verifone"].includes(i.external_reference))if(i.encrypted)_.checkout.monitorTransaction(i.encrypted);else{let t=parseInt((Date.now()-i.storage_time)/1e3),e=BXC_SETTINGS.countdown-Math.floor(t/60),n=60-t%60;n&&e--,this.initTransaction(i.id,i.amount,i.address_payment,i.cryptocurrency,i.external_reference,[e,n],i.custom_token,i.redirect)}p.hasClass("bxc-popup")&&_.checkout.openPopup(f)}_.getURL("card")&&this.completeTransaction(_.getURL("card"),i),_.getURL("pay")&&e.find(`.bxc-payment-methods [data-cryptocurrency="${_.getURL("pay")}"]`).e[0].click(),n&&n(t)})},initTransaction:function(i,a,r,c,o,s=!1,l=!1,d=!1,h=!1){let m=p.find(".bxc-pay-cnt"),g=m.find(".bxc-pay-address"),v=_.baseCode(c.toUpperCase()),y=m.find("[data-countdown]"),C={id:i,amount:a,address_payment:r,cryptocurrency:c,external_reference:o,custom_token:l,redirect:d,vat:h},T=_.network(c,!1);p.addClass("bxc-pay-cnt-active"),g.find(".bxc-text").html(v+T+" "+t("address")),g.find(".bxc-title").html(r),g.find(".bxc-clipboard").attr("data-text",window.btoa(r)),(g=m.find(".bxc-pay-amount")).find(".bxc-title").html(a+" "+v),g.find(".bxc-clipboard").attr("data-text",window.btoa(a)),p.attr("data-transaction-id",i),g=m.find(".bxc-qrcode-text"),m.find(".bxc-qrcode").attr("src",`https://api.qrserver.com/v1/create-qr-code/?size=500x500&data=${r}&color=${BXC_SETTINGS.qr_code_color}`),g.find("img").attr("src",l?l.img:`${BXC_URL}media/icon-${c}.svg`),g.find("div").html(t("Only send {T} to this address").replace("{T}",v+T)),y.html(""),u=s?[s[0],s[1],!0]:[BXC_SETTINGS.countdown,0,!0],clearInterval(x[f]),x[f]=setInterval(()=>{y.html(`${u[0]}:${u[1]<10?"0":""}${u[1]}`),u[1]--,u[1]<=0&&(u[0]<=0&&setTimeout(()=>{_.event("TransactionCancelled",C),this.cancelTransaction(),p.find("#bxc-expired-tx-id").html(i),p.removeClass("bxc-tx-cnt-active").addClass("bxc-failed-cnt-active")},500),u[0]<5&&u[2]&&(y.parent().addClass("bxc-countdown-expiring"),u[2]=!1),u[0]--,u[1]=59)},1e3),clearInterval(x["check-"+f]),x["check-"+f]=setInterval(()=>{b[f]||(b[f]=!0,n("check-transactions",{transaction_id:i},t=>{if(b[f]=!1,t){if("expired"==t)return;if(Array.isArray(t)&&"error"==t[0])return console.error(t[1]);this.monitorTransaction(t)}}))},5e3),this.storageTransaction(f,C),_.event("TransactionStarted",C),e(m,!1)},monitorTransaction:function(e){let i=this.storageTransaction(f),a="check-"+f;clearInterval(x[f]),clearInterval(x[a]),x[a]=setInterval(()=>{p&&!b[f]&&(b[f]=!0,n("check-transaction",{transaction:e},n=>{b[f]=!1,p.find(".bxc-tx-confirmations").html(n.confirmations+" / "+BXC_SETTINGS.confirmations),n.confirmations&&p.find(".bxc-tx-status").addClass("bxc-tx-status-confirmed").html(t("Confirmed")),n.confirmed&&(n.underpayment?(p.removeClass("bxc-tx-cnt-active").addClass("bxc-underpayment-cnt-active"),clearInterval(x[a]),p.find("#bxc-underpaid-tx-id").html(i.id),this.cancelTransaction()):(n.invoice&&window.open(n.invoice),this.completeTransaction(e,i,a)))}))},3e3),i&&(i.encrypted=e),f&&this.storageTransaction(f,i),p&&(p.addClass("bxc-tx-cnt-active"),p.find(".bxc-tx-status").removeClass("bxc-tx-status-confirmed").html(t("Pending")),p.find(".bxc-tx-confirmations").html("0 / "+BXC_SETTINGS.confirmations))},completeTransaction:function(t,e,i=!1){typeof BXC_WP_AJAX_URL!=g&&(T.ajax(BXC_WP_AJAX_URL,{action:"bxc_wp_ajax",type:_.getURL("plugin")+"-payment-complete",transaction:e},t=>{document.location.href=t}),p.find(".bxc-text").addClass("bxc-order-processing")),BXC_SETTINGS.webhook&&n("webhook",{transaction:t}),e.redirect?setTimeout(()=>{document.location.href=encodeURI(`${e.redirect}${e.redirect.includes("?")?"&":"?"}transaction_id=${e.id}&amount=${e.amount}&address=${e.address}&cryptocurrency=${e.cryptocurrency}&external_reference=${e.external_reference}`)},1e3):p.removeClass("bxc-tx-cnt-active").addClass("bxc-complete-cnt-active"),clearInterval(x[i]),_.event("TransactionCompleted",e),this.cancelTransaction()},cancelTransaction:function(){clearInterval(x[f]),clearInterval(x["check-"+f]),p.removeClass("bxc-pay-cnt-active"),b[f]=!1,this.storageTransaction(f,"delete"),f=!1,p=!1},storageTransaction:function(t,e){let n=c("bxc-active-transaction"),i=t in n;if(e)"delete"==e?delete n[t]:i&&!e.encrypted||(e.storage_time=Date.now(),n[t]=e);else if(i){if(n[t].encrypted||n[t].storage_time+6e4*BXC_SETTINGS.countdown>Date.now())return n[t];delete n[t]}return c("bxc-active-transaction",n),!1},show:function(t){l.find(`[data-boxcoin="${t}"] > div`).removeClass("bxc-hidden")},openPopup(t,e=!0){i(l.find(`[data-boxcoin="${t}"] `).find(".bxc-popup,.bxc-popup-overlay"),e)}},event:function(t,e={}){e.checkout_id=f;let n=new CustomEvent("BXC"+t,e);document.dispatchEvent(n)},baseCode:function(t){return t.replace("_tron","").replace("_TRON","")},network:function(e,n=!0){let i={ETH:["usdt","usdc","link","shib","bat"],TRX:["usdt_tron"],BSC:["bnb","busd"]};e=e.toLowerCase();for(var a in i)if(i[a].includes(e)){let e=a+" "+t("network");return n?`<span class="bxc-label">${e}</span>`:" "+t("on")+" "+e}return""}};window.BOXCoin=_,document.addEventListener("DOMContentLoaded",()=>{if(l=T(document.body),v)s();else{if(typeof BXC_URL!=g)return;for(var u=0;u<y.length;u++)if(["boxcoin","boxcoin-js"].includes(y[u].id)){let h=y[u].src.replace("js/client.js","").replace("js/client.min.js",""),m=r(h);h.includes("?")&&(h=h.substr(0,h.indexOf("?"))),T.load(h+"css/client.css",!1),"lang"in m&&(C=m.lang),h.includes("?")&&(h=h.substr(0,h.indexOf("?"))),d=v?[]:l.find("[data-boxcoin]"),T.ajax(h+"init.php",{init:!0,language:C},t=>{T.load(!1,!0,!1,t),d.e.forEach(t=>{_.checkout.init(_.checkout.settings(t),t)})}),s(),_.event("Init"),l.on("click",".bxc-payment-methods > div",function(){let i=T(a(this)),r=i.parent().attr("data-boxcoin");if(i.find(".bxc-input").removeClass("bxc-error"),i.find(".bxc-error").remove(),f&&r!=f)return i.find(".bxc-body").prepend(`<div class="bxc-error bxc-text">${t("Another transaction is being processed. Complete the transaction or cancel it to start a new one.")}</div>`),void setTimeout(()=>{i.find(".bxc-error").remove()},1e4);p=i,f=r;let o=T(this).attr("data-cryptocurrency"),s=p.attr("data-external-reference"),l=p.attr("data-price"),d=p.find("#user-amount"),u=T(this).attr("data-custom-coin"),h=i.find(".bxc-vat"),m=!1;l&&-1!=l||(l=d.find("input").val())?(u&&(u={type:u,img:T(this).find("img").attr("src")}),p.find('#bxc-billing [name="name"]').val().trim()&&(m={},p.find("#bxc-billing input, #bxc-billing select").e.forEach(t=>{m[T(t).attr("name")]=T(t).val()}),c("bxc-billing",m)),h=!(!h.e.length||!h.attr("data-amount"))&&{amount:h.attr("data-amount"),percentage:h.attr("data-percentage"),country:h.attr("data-country"),country_code:h.attr("data-country-code")},p.addClass("bxc-pay-cnt-active"),e(p.find(".bxc-pay-cnt")),n("create-transaction",{amount:l,cryptocurrency_code:o,currency_code:p.attr("data-currency"),external_reference:p.attr("data-external-reference"),title:p.attr("data-title"),description:p.attr("data-description"),custom_token:u,url:document.location.href,billing:m?JSON.stringify(m):"",vat:h},t=>{if(!Array.isArray(t))return console.error(t);if(["stripe","verifone"].includes(o)){let e={id:t[0],amount:l,external_reference:o};_.checkout.storageTransaction(f,e),_.event("TransactionStarted",e),document.location=t[2]}else _.checkout.initTransaction(t[0],t[1],t[2],o,s,!1,u,p.attr("data-redirect"),h)})):d.addClass("bxc-error")}),l.on("click",".bxc-back",function(){p.find(".bxc-pay-top-main").addClass("bxc-hidden")}),l.on("click","#bxc-abort-cancel, #bxc-confirm-cancel",function(){p.find(".bxc-pay-top-main").removeClass("bxc-hidden")}),l.on("click","#bxc-confirm-cancel",function(){_.event("TransactionCancelled",_.checkout.storageTransaction(f)),_.checkout.cancelTransaction()}),l.on("click",".bxc-failed-cnt .bxc-btn",function(){p.removeClass("bxc-failed-cnt-active")}),l.on("click",".bxc-btn-popup,.bxc-popup-close",function(){i(T(this.closest("[data-boxcoin]")).find(".bxc-popup,.bxc-popup-overlay"),T(this).hasClass("bxc-btn-popup"))}),l.on("click",".bxc-collapse-btn",function(){T(this).parent().removeClass("bxc-collapse"),T(this).remove()}),l.on("click","#bxc-btn-invoice",function(){let t=c("bxc-billing"),e=T('#bxc-billing [name="country"]');if(t)for(var n in t)T(`#bxc-billing [name="${n}"]`).val(t[n]);else e.val(T(this.closest(".bxc-main")).find(".bxc-vat").attr("data-country"));T(this).remove(),o(e.e[0]),T("#bxc-billing").removeClass("bxc-hidden")}),l.on("change",'#bxc-billing [name="country"]',function(){o(this)}),l.on("focusout",'#bxc-billing [name="vat"]',function(){let t=T(this).val();if(BXC_SETTINGS.vat_validation&&t.length>5&&t.charAt(0).match(/[A-Z]/i)){let i=T(this.closest(".bxc-main")),a=i.find(".bxc-vat");e(a),n("vat-validation",{vat_number:t},t=>{if(t&&t.data&&t.data.valid){let t=i.attr("data-start-price");i.find(".bxc-vat").html(""),i.attr("data-price",t),i.find(".bxc-amount-fiat-total").html(t)}else o(T('#bxc-billing [name="country"]').e[0]);e(a,!1)})}});break}}l.on("click",".bxc-select",function(){let t=T(this).find("ul"),e=t.hasClass("bxc-active");i(t,!e),v&&!e&&setTimeout(()=>{BXCAdmin.active_element=t.e[0]},300)}),l.on("click",".bxc-select li",function(){let t=T(this.closest(".bxc-select")),e=T(this).attr("data-value");var n=t.find(`[data-value="${e}"]`);i(t.find("li"),!1),t.find("p").attr("data-value",e).html(n.html()),i(n,!0),v&&(BXCAdmin.active_element=!1)})},!1)}();